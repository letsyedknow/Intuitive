##Find the top3 fastest-speed bird associated with Wingspan, food-token and habitat(s).

select b.* from (select bird_id,bird_name,food_token_id,habitat_id,wingspan,dense_rank() over(partition by food_token_id,habitat_id order by wingspan desc) as bird_rank from bird   ) b where b.bird_rank=1 ;


##Finds duplicates

select b.* from bird b 
join (select bird_name,food_token_id,habitat_id,count(1) from bird group by 1,2,3 having count(1)>=2  ) d 
on b.bird_name=d.bird_name;



---TOTAL_POINT AND CREDIT AFTER THE GAME
SELECT AR.GAME_ID,AR.USER_ID,SUM(AR.LAST_POINTS) AS TOTAL_POINTS,DENSE_RANK() OVER (ORDER BY SUM(AR.LAST_POINTS) DESC ) AS CREDIT_RANK 
FROM
( --SUM OF POINTS AFTER EACH ROUND
SELECT G.GAME_ID,G.ROUND,G.USER_ID,SUM(B.POINT) AS LAST_POINTS 
			   FROM (SELECT GAME_ID,ROUND,USER_ID,UNNEST(CARD_IN_HAND) AS CARD_ASSET_ID 
			               FROM GAME) G
JOIN BIRD B
ON G.CARD_ASSET_ID=B.CARD_ASSET_ID
GROUP BY 1,2,3
) AR
GROUP BY 1,2;	


